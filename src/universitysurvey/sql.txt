--Creating tables

--Department table
create table Departments (
    depName varchar(25) not null,
    constraint depName_pk primary key (depName)
);

--Course table
create table Courses (
    courseNum int not null,
    depName varchar(25) not null,
    courseName varchar(25) not null,
    courseUnits int not null,
    constraint depName_fk foreign key (depName) references Departments (depName),
    constraint course_pk primary key (courseNum, depName)
);

--Section table
--Figure out how to put in the day
--time is varchar because of am and pm
create table Sections (
    depName varchar(25) not null,
    courseNum int not null,
    secNum int not null,
    startTime varchar(20) not null,
    endTime varchar(20) not null,
    meetingDays varchar(20) not null,
    constraint sectionCourse_fk foreign key (courseNum, depName) references Courses (courseNum, depName),
    constraint section_pk primary key (depName, courseNum, secNum)
);

--Student table
create table Students (
    studentID int not null,
    firstName varchar(25) not null,
    lastName varchar(25) not null,
    email varchar(50) not null,
    constraint student_pk primary key (studentID)
);

--Enrollment table
create table Enrollment( 
    studentID int not null,
    depName varchar(25) not null,
    courseNum int not null,
    secNum int not null,
    constraint enrollmentSec_fk foreign key (depName, courseNum, secNum) references Sections (depName, courseNum, secNum),
    constraint enrollmentStudent_fk foreign key (studentID) references Students (studentID),
    constraint enrollment_pk primary key (studentID, depName, courseNum, secNum)
);

--Team table
create table Team(
    teamName varchar(25) not null,
    secNum int not null,
    depName varchar(25) not null,
    courseNum int not null,
    constraint team_fk foreign key (secNum, depName, courseNum) references Sections (secNum, depName, courseNum),
    constraint team_pk primary key (teamName, secNum, depName, courseNum)
);

--Team Member table
create table TeamMember(
    studentID int not null,
    teamName varchar(25) not null,
    secNum int not null,
    depName varchar(25) not null,
    courseNum int not null,
    constraint teamMember_fk foreign key (teamName, secNum, depName, courseNum) references Team (teamName, secNum, depName, courseNum),
    constraint teamStudentID_fk foreign key (studentID) references Students (studentID),
    constraint teamMember_pk primary key (studentID, teamName, secNum, depName, courseNum)
);

--Dimension table
--dimension are questions that will be ask on the survey
create table Dimension (
    diName varchar(25) not null,
    secNum int not null,
    depName varchar(25) not null,
    courseNum int not null,
    constraint dimension_fk foreign key (depName, courseNum, secNum) references Sections (depName, courseNum, secNum),
    constraint dimension_pk primary key (diName, secNum, courseNum, depName)
);

--Survey table
--rating target is the student ID of the student that is being rated
create table Surveys (
    ratingTarget int not null,
    studentID int not null,
    teamName varchar(25) not null,
    secNum int not null,
    depName varchar(25) not null,
    courseNum int not null,
    constraint survey_fk foreign key (studentID, teamName, secNum, depName, courseNum) references TeamMember (studentID, teamName, secNum, depName, courseNum),
    constraint survey_pk primary key (ratingTarget, studentID, teamName, secNum, depName, courseNum)
);

--SuveryRating table
create table SurveyRating (
    ratingTarget int not null,
    studentID int not null,
    teamName varchar(25) not null,
    secNum int not null,
    depName varchar(25) not null,
    courseNum int not null,
    diName varchar(25) not null,
    rating int not null,
    constraint surveyRating_fk foreign key (ratingTarget, studentID, teamName, secNum, depName, courseNum) references Surveys (ratingTarget, studentID, teamName, secNum, depName, courseNum),
    constraint surveyRatingDi_fk foreign key (diName, secNum, courseNum, depName) references Dimension (diName, secNum, courseNum, depName),
    constraint surveyRatingTarget_fk foreign key (ratingTarget, depName, courseNum, secNum) references Enrollment (studentID, depName, courseNum, secNum),
    constraint surveyRatingStu_fk foreign key (studentID, depName, courseNum, secNum) references Enrollment (studentID, depName, courseNum, secNum),
    constraint surveyRating_pk primary key (diName, ratingTarget, studentID, secNum, depName, courseNum)
);

ALTER TABLE Enrollment
ADD grade varchar(3);

ALTER TABLE Courses
ADD courseDes varchar(100);

ALTER TABLE Sections
ADD instructor varchar(100);

--Insert value into Departments
insert into departments (depname) values
('CECS'),
('Physics'),
('Business');

--Insert value into Courses
insert into Courses (coursenum, depname, coursename, courseunits, coursedes) values
(323, 'CECS', 'Database', 3, 'Database fundamentals using Derby database and mySQL'),
(328, 'CECS', 'Algorithm', 3, 'Basic of algorithms such as sorting, Dijktra, BFS, DFS and so on'),
(151, 'Physics', 'Netownian Physics', 4, 'Speed, velocity, momentum, kinetic energy and more'),
(152, 'Physics', 'Electricity & Magnetism', 4, 'fundametals of electric and magnetic field and circuits');

--Insert into Students
insert into Students (studentID, firstName, lastName, Email) values
(22, 'Teostra', 'Smith', 'Teostra@gmail.com'),
(23, 'Lunastra', 'Snow', 'Lunastra@gmail.com'),
(24, 'Fatalis', 'Dow', 'Fatalis@gmail.com');

--Insert into sections
insert into Sections (coursenum, depname, secnum, instructor, starttime, endtime, meetingdays) values
(323, 'CECS', 8, 'Mimi Opkins', '17:30', '19:00', 'MW'),
(328, 'CECS', 2, 'Pouye', '18:00', '20:00', 'TTh');

insert into Sections (coursenum, depname, secnum, instructor, starttime, endtime, meetingdays) values
(152, 'Physics', 7, 'Gintoki Sakata', '9:00', '11:00', 'MW');

--Insert into team
insert into Team (teamname, secnum, depname, coursenum) values
('JavaBeans', 8, 'CECS', 323),
('Dolphins', 8, 'CECS', 323),
('Shark', 2, 'CECS', 328);

insert into Team (teamname, secnum, depname, coursenum) values
('ShrodingerCat', 7, 'Physics', 152);

--Insert into enrollment
insert into Enrollment (studentID, depName, courseNum, secNum, grade, teamname) values
(22, 'CECS', 323, 8, 'A', 'Dolphins'),
(24, 'CECS', 323, 8, 'B', 'JavaBeans'),
(23, 'CECS', 328, 2, 'A', 'Shark');

--insert into Students
insert into Students (studentID, firstName, lastName, Email) values
(25, 'Fatalis', 'Do', 'alis@gmail.com'),
(26, 'Fatalis', 'Do', 'vganesh@optonline.net'),
(27, 'Gerard', 'Sandoval', 'storerm@mac.com’),
(28, 'Latoya', 'Rogers', 'dwheeler@msn.com'),

(29, 'Mabel', 'Duncan', 'mahbub@mac.com'),
(30, 'Woodrow', 'Price', 'jaesenj@msn.com'),
(31, 'Courtney', 'Johnston', 'froodian@yahoo.ca'),
(32, 'John', 'Banks', 'granboul@live.com'),

(33, 'Bob', 'Do', 'drjlaw@optonline.net'),
(34, 'Rob', 'Hope', 'keiji@outlook.com'),
(35, 'Tran', ‘Tram', 'xtang@att.net'),
(36, 'Fat', 'Dom', 'jhardin@hotmail.com');


--insert into Enrollment
insert into Enrollment (studentID, depName, courseNum, secNum, grade, teamname) values
(25, 'Physics', 152,7, 'B', 'ShrodingerCat' ),
(26, 'Physics', 152, 7,'A', 'ShrodingerCat'),
(27, 'Physics', 152, 7, 'C', 'ShrodingerCat'),
(28, 'Physics', 152, 7, 'B', 'ShrodingerCat'),


(29,  'CECS',323, 8, 'B', 'Dolphins'),

(30,  'CECS',323,8,'B', 'JavaBeans'),
(31, 'CECS',323,8,'B', 'JavaBeans'),
(32,  'CECS',323, 8, 'B', 'JavaBeans'),
(33,  'CECS',323, 8,'D', 'JavaBeans'),
(34,  'CECS',323, 8,'A', 'JavaBeans');

--Insert into Dimension
insert into Dimension(diName,secNum,depName,courseNum) values
('Trustworthiness', 2, 'CECS',328),
('Contribution', 2, 'CECS',328),
('Meeting Punctuality', 2, 'CECS',328),

('Trustworthiness', 8, 'CECS',323),
('Contribution', 8, 'CECS',323),
('Meeting Punctuality', 8, 'CECS',323),

('Trustworthiness', 7, 'Physics',152),
('Contribution', 7, 'Physics',152),
('Meeting Punctuality', 7, 'Physics',152);

--insert into SurveyRating
insert into SurveyRating(ratingTarget, studentID, secNum, depName, courseNum, diName, rating) values
--ID  24 being rated
(24, 30, 8 , 'CECS', 323, 'Trustworthiness', 3),
(24, 30, 8 , 'CECS', 323, 'Contribution', 2),
(24, 30, 8 , 'CECS', 323, 'Meeting Punctuality', 1),

(24, 31, 8 , 'CECS', 323, 'Trustworthiness', 2),
(24, 31, 8 , 'CECS', 323, 'Contribution', 5),
(24, 31, 8 , 'CECS', 323, 'Meeting Punctuality', 3),


(24, 32, 8 , 'CECS', 323, 'Trustworthiness', 3),
(24, 32, 8 , 'CECS', 323, 'Contribution', 4),
(24, 32, 8 , 'CECS', 323, 'Meeting Punctuality', 1),

(24, 33, 8 , 'CECS', 323, 'Trustworthiness', 2),
(24, 33, 8 , 'CECS', 323, 'Contribution', 3),
(24, 33, 8 , 'CECS', 323, 'Meeting Punctuality', 1),

(24, 34, 8 , 'CECS', 323, 'Trustworthiness', 3),
(24, 34, 8 , 'CECS', 323, 'Contribution', 4),
(24, 34, 8 , 'CECS', 323, 'Meeting Punctuality', 5),

--30 being rated
(30, 24, 8 , 'CECS', 323, 'Trustworthiness', 3),
(30, 24, 8 , 'CECS', 323, 'Contribution', 5),
(30, 24, 8 , 'CECS', 323, 'Meeting Punctuality', 2),

(30, 31, 8 , 'CECS', 323, 'Trustworthiness', 4),
(30, 31, 8 , 'CECS', 323, 'Contribution', 2),
(30, 31, 8 , 'CECS', 323, 'Meeting Punctuality', 1),

(30, 32, 8 , 'CECS', 323, 'Trustworthiness', 4),
(30, 32, 8 , 'CECS', 323, 'Contribution', 5),
(30, 32, 8 , 'CECS', 323, 'Meeting Punctuality', 3),

(30, 33, 8 , 'CECS', 323, 'Trustworthiness', 5),
(30, 33, 8 , 'CECS', 323, 'Contribution', 1),
(30, 33, 8 , 'CECS', 323, 'Meeting Punctuality', 2),

(30, 34, 8 , 'CECS', 323, 'Trustworthiness', 4),
(30, 34, 8 , 'CECS', 323, 'Contribution', 5),
(30, 34, 8 , 'CECS', 323, 'Meeting Punctuality', 3),

--31 being rated
(31, 30, 8 , 'CECS', 323, 'Trustworthiness', 3),
(31, 30, 8 , 'CECS', 323, 'Contribution', 1),
(31, 30, 8 , 'CECS', 323, 'Meeting Punctuality', 5),

(31, 24, 8 , 'CECS', 323, 'Trustworthiness', 2),
(31, 24, 8 , 'CECS', 323, 'Contribution', 1),
(31, 24, 8 , 'CECS', 323, 'Meeting Punctuality', 4),

(31, 32, 8 , 'CECS', 323, 'Trustworthiness', 2),
(31, 32, 8 , 'CECS', 323, 'Contribution', 4),
(31, 32, 8 , 'CECS', 323, 'Meeting Punctuality', 5),

(31, 33, 8 , 'CECS', 323, 'Trustworthiness', 1),
(31, 33, 8 , 'CECS', 323, 'Contribution', 3),
(31, 33, 8 , 'CECS', 323, 'Meeting Punctuality', 2),

(31, 34, 8 , 'CECS', 323, 'Trustworthiness', 5),
(31, 34, 8 , 'CECS', 323, 'Contribution', 4),
(31,34, 8 , 'CECS', 323, 'Meeting Punctuality', 2),

--32 being rated
(32, 30, 8 , 'CECS', 323, 'Trustworthiness', 3),
(32, 30, 8 , 'CECS', 323, 'Contribution', 5),
(32, 30, 8 , 'CECS', 323, 'Meeting Punctuality', 4),

(32, 31, 8 , 'CECS', 323, 'Trustworthiness', 2),
(32, 31, 8 , 'CECS', 323, 'Contribution', 1),
(32, 31, 8 , 'CECS', 323, 'Meeting Punctuality', 3),

(32, 24, 8 , 'CECS', 323, 'Trustworthiness', 1),
(32, 24, 8 , 'CECS', 323, 'Contribution', 2),
(32, 24, 8 , 'CECS', 323, 'Meeting Punctuality', 4),

(32, 33, 8 , 'CECS', 323, 'Trustworthiness', 2),
(32, 33, 8 , 'CECS', 323, 'Contribution', 5),
(32, 33, 8 , 'CECS', 323, 'Meeting Punctuality', 5),

(32, 34, 8 , 'CECS', 323, 'Trustworthiness', 4),
(32, 34, 8 , 'CECS', 323, 'Contribution', 5),
(32, 34, 8 , 'CECS', 323, 'Meeting Punctuality', 5),

--33 being rated
(33, 30, 8 , 'CECS', 323, 'Trustworthiness', 2),
(33, 30, 8 , 'CECS', 323, 'Contribution', 5),
(33, 30, 8 , 'CECS', 323, 'Meeting Punctuality', 3),

(33, 31, 8 , 'CECS', 323, 'Trustworthiness', 5),
(33, 31, 8 , 'CECS', 323, 'Contribution', 2),
(33, 31, 8 , 'CECS', 323, 'Meeting Punctuality', 1),

(33, 24, 8 , 'CECS', 323, 'Trustworthiness', 3),
(33, 24, 8 , 'CECS', 323, 'Contribution', 4),
(33, 24, 8 , 'CECS', 323, 'Meeting Punctuality', 1),

(33, 32, 8 , 'CECS', 323, 'Trustworthiness', 2),
(33, 32, 8 , 'CECS', 323, 'Contribution', 3),
(33, 32, 8 , 'CECS', 323, 'Meeting Punctuality', 5),

(33, 34, 8 , 'CECS', 323, 'Trustworthiness', 2),
(33, 34, 8 , 'CECS', 323, 'Contribution', 2),
(33, 34, 8 , 'CECS', 323, 'Meeting Punctuality', 3),

--34 being rated
(34, 30, 8 , 'CECS', 323, 'Trustworthiness', 5),
(34, 30, 8 , 'CECS', 323, 'Contribution', 4),
(34, 30, 8 , 'CECS', 323, 'Meeting Punctuality', 5),

(34, 31, 8 , 'CECS', 323, 'Trustworthiness', 3),
(34, 31, 8 , 'CECS', 323, 'Contribution', 3),
(34, 31, 8 , 'CECS', 323, 'Meeting Punctuality', 4),

(34, 24, 8 , 'CECS', 323, 'Trustworthiness', 4),
(34, 24, 8 , 'CECS', 323, 'Contribution', 5),
(34, 24, 8 , 'CECS', 323, 'Meeting Punctuality', 5),

(34, 32, 8 , 'CECS', 323, 'Trustworthiness', 5),
(34, 32, 8 , 'CECS', 323, 'Contribution', 3),
(34, 32, 8 , 'CECS', 323, 'Meeting Punctuality', 4),

(34, 33, 8 , 'CECS', 323, 'Trustworthiness', 2),
(34, 33, 8 , 'CECS', 323, 'Contribution', 5),
(34, 33, 8 , 'CECS', 323, 'Meeting Punctuality', 3);

--Testing SQL for functions
--Listing all team members for each team
SELECT * FROM enrollment order by depname, coursenum, secnum, teamname;
    constraint surveyRating_pk primary key (diName, ratingTarget, studentID, teamName, secNum, depName, courseNum)
);