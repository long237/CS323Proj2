--Creating tables

--Department table
create table Departments (
    depName varchar(25) not null,
    constraint depName_pk primary key (depName)
);

--Course table
create table Courses (
    courseNum int not null,
    depName varchar(25) not null,
    courseName varchar(25) not null,
    courseUnits int not null,
    constraint depName_fk foreign key (depName) references Departments (depName),
    constraint course_pk primary key (courseNum, depName)
);

--Section table
--Figure out how to put in the day
--time is varchar because of am and pm
create table Sections (
    depName varchar(25) not null,
    courseNum int not null,
    secNum int not null,
    startTime varchar(20) not null,
    endTime varchar(20) not null,
    meetingDays varchar(20) not null,
    constraint sectionCourse_fk foreign key (courseNum, depName) references Courses (courseNum, depName),
    constraint section_pk primary key (depName, courseNum, secNum)
);

--Student table
create table Students (
    studentID int not null,
    firstName varchar(25) not null,
    lastName varchar(25) not null,
    email varchar(50) not null,
    constraint student_pk primary key (studentID)
);

--Enrollment table
create table Enrollment( 
    studentID int not null,
    depName varchar(25) not null,
    courseNum int not null,
    secNum int not null,
    constraint enrollmentSec_fk foreign key (depName, courseNum, secNum) references Sections (depName, courseNum, secNum),
    constraint enrollmentStudent_fk foreign key (studentID) references Students (studentID),
    constraint enrollment_pk primary key (studentID, depName, courseNum, secNum)
);

--Team table
create table Team(
    teamName varchar(25) not null,
    secNum int not null,
    depName varchar(25) not null,
    courseNum int not null,
    constraint team_fk foreign key (secNum, depName, courseNum) references Sections (secNum, depName, courseNum),
    constraint team_pk primary key (teamName, secNum, depName, courseNum)
);

--Team Member table
create table TeamMember(
    studentID int not null,
    teamName varchar(25) not null,
    secNum int not null,
    depName varchar(25) not null,
    courseNum int not null,
    constraint teamMember_fk foreign key (teamName, secNum, depName, courseNum) references Team (teamName, secNum, depName, courseNum),
    constraint teamStudentID_fk foreign key (studentID) references Students (studentID),
    constraint teamMember_pk primary key (studentID, teamName, secNum, depName, courseNum)
);

--Dimension table
--dimension are questions that will be ask on the survey
create table Dimension (
    diName varchar(25) not null,
    secNum int not null,
    depName varchar(25) not null,
    courseNum int not null,
    constraint dimension_fk foreign key (depName, courseNum, secNum) references Sections (depName, courseNum, secNum),
    constraint dimension_pk primary key (diName, secNum, courseNum, depName)
);

--Survey table
--rating target is the student ID of the student that is being rated
create table Surveys (
    ratingTarget int not null,
    studentID int not null,
    teamName varchar(25) not null,
    secNum int not null,
    depName varchar(25) not null,
    courseNum int not null,
    constraint survey_fk foreign key (studentID, teamName, secNum, depName, courseNum) references TeamMember (studentID, teamName, secNum, depName, courseNum),
    constraint survey_pk primary key (ratingTarget, studentID, teamName, secNum, depName, courseNum)
);

--SuveryRating table
create table SurveyRating (
    ratingTarget int not null,
    studentID int not null,
    teamName varchar(25) not null,
    secNum int not null,
    depName varchar(25) not null,
    courseNum int not null,
    diName varchar(25) not null,
    rating int not null,
    constraint surveyRating_fk foreign key (ratingTarget, studentID, teamName, secNum, depName, courseNum) references Surveys (ratingTarget, studentID, teamName, secNum, depName, courseNum),
    constraint surveyRatingDi_fk foreign key (diName, secNum, courseNum, depName) references Dimension (diName, secNum, courseNum, depName),
    constraint surveyRating_pk primary key (diName, ratingTarget, studentID, teamName, secNum, depName, courseNum)
);